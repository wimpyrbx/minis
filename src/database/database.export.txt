-- Database Schema Export
-- Generated at: 2024-11-21T19:48:57.714Z
-- ----------------------------------------


CREATE TABLE mini_categories  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          image_path TEXT,
    
          UNIQUE (
    name
)
      
)

CREATE TABLE mini_to_categories  (
    
    mini_id INTEGER NOT NULL,
    
    category_id INTEGER NOT NULL,
    
    FOREIGN KEY  (
    mini_id
) REFERENCES minis (
    id
) ON DELETE CASCADE,
    
    FOREIGN KEY  (
    category_id
) REFERENCES mini_categories (
    id
) ON DELETE CASCADE,
    
    PRIMARY KEY  (
    mini_id,
     category_id
)

)

CREATE TABLE mini_to_product_sets  (
    
    mini_id INTEGER NOT NULL,
    
    set_id INTEGER NOT NULL,
    
    FOREIGN KEY  (
    mini_id
) REFERENCES minis (
    id
) ON DELETE CASCADE,
    
    FOREIGN KEY  (
    set_id
) REFERENCES product_sets (
    id
) ON DELETE CASCADE,
    
    PRIMARY KEY  (
    mini_id,
     set_id
)

)

CREATE TABLE mini_to_proxy_types  (
    
    mini_id INTEGER NOT NULL,
    
    type_id INTEGER NOT NULL,
    
    FOREIGN KEY  (
    mini_id
) REFERENCES minis (
    id
) ON DELETE CASCADE,
    
    FOREIGN KEY  (
    type_id
) REFERENCES mini_types (
    id
) ON DELETE CASCADE,
    
    PRIMARY KEY  (
    mini_id,
     type_id
)

)

CREATE TABLE mini_to_tags  (
    
    mini_id INTEGER NOT NULL,
    
    tag_id INTEGER NOT NULL,
    
    FOREIGN KEY  (
    mini_id
) REFERENCES minis (
    id
) ON DELETE CASCADE,
    
    FOREIGN KEY  (
    tag_id
) REFERENCES tags (
    id
) ON DELETE CASCADE,
    
    PRIMARY KEY  (
    mini_id,
     tag_id
)

)

CREATE TABLE mini_to_types  (
    
    mini_id INTEGER NOT NULL,
    
    type_id INTEGER NOT NULL,
    
    FOREIGN KEY  (
    mini_id
) REFERENCES minis (
    id
) ON DELETE CASCADE,
    
    FOREIGN KEY  (
    type_id
) REFERENCES mini_types (
    id
) ON DELETE CASCADE,
    
    PRIMARY KEY  (
    mini_id,
     type_id
)

)

CREATE TABLE mini_types  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          category_id INTEGER NOT NULL,
    
          image_path TEXT,
    
          FOREIGN KEY  (
    category_id
) REFERENCES mini_categories (
    id
) ON DELETE CASCADE,
    
          UNIQUE (
    name,
     category_id
)
      
)

CREATE TABLE minis  (
    
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    
    name TEXT NOT NULL,
    
    description TEXT,
    
    location TEXT NOT NULL,
      -- Now required
    image_path TEXT,
    
    quantity INTEGER DEFAULT 1 CHECK  (
    quantity >= 0
),
    
    created_at TEXT DEFAULT  (
    datetime (
    'now'
)
),
    
    updated_at TEXT DEFAULT  (
    datetime (
    'now'
)
)
,
     original_image_path TEXT,
     painted_by TEXT NOT NULL DEFAULT 'prepainted' CHECK  (
    painted_by IN  (
    'prepainted',
     'self',
     'other'
)
),
     base_size TEXT NOT NULL DEFAULT 'medium' CHECK  (
    base_size IN  (
    'tiny',
     'small',
     'medium',
     'large',
     'huge',
     'gargantuan',
     'colossal',
     'colossal+'
)
)
)

CREATE TABLE product_lines  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          company_id INTEGER NOT NULL,
    
          FOREIGN KEY  (
    company_id
) REFERENCES production_companies (
    id
) ON DELETE CASCADE,
    
          UNIQUE (
    name,
     company_id
)
      
)

CREATE TABLE product_sets  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          product_line_id INTEGER NOT NULL,
    
          FOREIGN KEY  (
    product_line_id
) REFERENCES product_lines (
    id
) ON DELETE CASCADE,
    
          UNIQUE (
    name,
     product_line_id
)
      
)

CREATE TABLE production_companies  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          UNIQUE (
    name
)
      
)

CREATE TABLE settings  (
    
          settings_id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          setting_name TEXT NOT NULL UNIQUE,
    
          setting_value TEXT NOT NULL
      
)

CREATE TABLE sqlite_sequence (
    name,
    seq
)

CREATE TABLE tags  (
    
          id INTEGER PRIMARY KEY AUTOINCREMENT,
    
          name TEXT NOT NULL,
    
          UNIQUE (
    name
)
      
)
